<!doctype html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="renderer" content="webkit" />






















	
		
		
		
	




	









<script type="text/javascript">
    window._ResourceStringCache = window._ResourceStringCache || {};
    
    window._ResourceStringCache['date.format.time']='HH:mm';
    window._ResourceStringCache['date.format.datetime.2y']='yy-MM-dd HH:mm';
    window._ResourceStringCache['date.format.date.2y']='yy-MM-dd';
    window._ResourceStringCache['date.format.date7y']='yy-mm';
    window._ResourceStringCache['date.format.yearMonth']='yyyy-MM';
    window._ResourceStringCache['date.format.year']='yyyy';
    window._ResourceStringCache['return.noRecord']='很抱歉，未找到符合条件的记录！';
    window._ResourceStringCache['button.fold']='收起';
    window._ResourceStringCache['operation.more']='更多';
</script>


<script type="text/javascript">
	
var Com_Parameter = {
	ContextPath:"/",
	ResPath:"/resource/",
	Style:"default",
	JsFileList:new Array,
	StylePath:"/resource/style/default/",
	Lang:"zh-cn",
	OfficialLang:"cn",
	CurrentUserId:"178259de6ca7ec345ecb20140c582b7a",
	Cache:1732772503739,
	FirstDayInWeek: parseInt('1') - 1,
	CalendarMinuteStep:parseInt('1'),
	SessionExpireTip:"会话过期，请打开新页面重新登录后再提交本页面。",
	ServiceNotAvailTip:"与服务器连接不通，请联系系统管理员或等会再试。",
	Date_format:"yyyy-MM-dd",
	Date_format_yearMonth:"yyyy-MM",
	DateTime_format:"yyyy-MM-dd HH:mm",
	SoftDeleteEnableModules:"com.landray.kmss.km.doc.model.KmDocKnowledge,com.landray.kmss.kms.wiki.model.KmsWikiMain,com.landray.kmss.km.smissive.model.KmSmissiveMain,com.landray.kmss.kms.multidoc.model.KmsMultidocKnowledge,com.landray.kmss.hr.ratify.model.HrRatifyMain,com.landray.kmss.fssc.fee.model.FsscFeeMain,com.landray.kmss.km.review.model.KmReviewMain,com.landray.kmss.fssc.loan.model.FsscLoanRepayment,com.landray.kmss.fssc.expense.model.FsscExpenseBalance,com.landray.kmss.fssc.loan.model.FsscLoanMain,com.landray.kmss.fssc.budget.model.FsscBudgetAdjustMain,com.landray.kmss.km.supervise.model.KmSuperviseMain,com.landray.kmss.sys.news.model.SysNewsMain,com.landray.kmss.km.archives.model.KmArchivesMain,com.landray.kmss.km.archives.model.KmArchivesBorrow,com.landray.kmss.fssc.expense.model.FsscExpenseMain,com.landray.kmss.km.contract.model.KmContractMain,com.landray.kmss.fssc.expense.model.FsscExpenseShareMain,com.landray.kmss.fssc.loan.model.FsscLoanTransfer,com.landray.kmss.km.imissive.model.KmImissiveSendMain,com.landray.kmss.km.imissive.model.KmImissiveSignMain,com.landray.kmss.km.imissive.model.KmImissiveReceiveMain",
	ComfirmDelete:"一旦选择了删除，所选记录的相关数据都会被删除，无法恢复！您确认要执行此删除操作吗？",
	ComfirmSoftDelete:"您确定要将所选记录放入回收站吗？<br><span style='color:red'>(20天后将自动彻底删除)</span>",
	OptSuccessInfo:"您的操作已成功！",
	OptFailureInfo:"操作失败！",
	clientType:"-1",
	serverPrefix : "https://ekpdemo.landray.com.cn",
	isSysMouring : "false",
	isEnabledEco: "false",
	isExternal : "false",
	dingXForm : "false",
	smallMaxSize : "600",
	attendanceEnabled : "false",
	isFromDingPC : "false",
	possibleResourceSites : []
};

</script>
<!-- 是否开启合并加载js模式  -->

	
	
		<script type="text/javascript" src='/resource/js/domain.js?s_cache=1732772503739'></script>
		<script type="text/javascript" src='/sys/ui/js/LUI.js?s_cache=1732772503739'></script>
		<script type="text/javascript" src="/resource/js/common.js?s_cache=1732772503739"></script>
		<script type="text/javascript" src="/resource/js/sea.js?s_cache=1732772503739"></script>
	


<script type="text/javascript">
seajs.config({
	themes : {
    "calendar": ["sys/ui/extend/theme/default/style/calendar.css"],
    "widget": ["sys/ui/extend/theme/default/style/widget.css"],
    "select": ["sys/ui/extend/theme/default/style/select.css"],
    "iconfont": ["sys/ui/extend/theme/default/style/iconfont.css"],
    "profile": ["sys/ui/extend/theme/default/style/profile.css"],
    "module": ["sys/ui/extend/theme/default/style/module.css"],
    "listview": ["sys/ui/extend/theme/default/style/listview.css"],
    "icon": ["sys/ui/extend/theme/default/style/icon.css"],
    "treefont": ["sys/ui/extend/theme/default/style/treefont.css"],
    "dialog": ["sys/ui/extend/theme/default/style/dialog.css"],
    "common": ["sys/ui/extend/theme/default/style/common.css"],
    "form": ["sys/ui/extend/theme/default/style/form.css"],
    "zone": ["sys/ui/extend/theme/default/style/zone.css"],
    "sns": ["sys/ui/extend/theme/default/style/sns.css"],
    "step": ["sys/ui/extend/theme/default/style/step.css"],
    "portal": ["sys/ui/extend/theme/default/style/portal.css"],
    "chart": ["sys/ui/extend/theme/default/style/chart.css"],
    "prompt": ["sys/ui/extend/theme/default/style/listview.css"]
},
	paths: {
		'lui': 'sys/ui/js'
	},
	alias: {
		'lui/jquery': 'resource/js/jquery',
		'lui/jquery-ui': 'resource/js/jquery-ui/jquery.ui'
	},
	preload: ['/resource/js/plugin-theme.js','/resource/js/plugin-lang.js'],
	debug: true,
 	base: '',
 	env : {
 	 	contextPath: '',
 		now : '2024-11-28 17:17',
 		pageMaxWidth:'1920px',
 		pattern : {
 			date : 'yyyy-MM-dd',
 			datetime : 'yyyy-MM-dd HH:mm',
 			time : 'HH:mm',
			yearMonth :"yyyy-MM",
			year :"yyyy"
 		},
 		locale : "zh-cn",
 		config : {},
 		cache : 1732772503739
 	}
});
</script>

<!-- 是否开启合并加载js模式  -->

	






	
	
	
		<script type="text/javascript">
			seajs.use([ 'lui/parser', 'lui/jquery', 'lui/dialog', 'theme!common', 'theme!icon','theme!iconfont' ],function(parser, $) {

                $.ajaxSettings.beforeSend=function(cb,cd){
                    try{
                        if(window.siteSelect){
                            this.url=siteSelect(this.url);
                        }
                    }catch(e){}
                };


				$(document).ready(function() {
					parser.parse();
				});
			});
		</script>
	


<link rel="shortcut icon" href="/favicon.ico">


<script type="text/javascript">
	// 获取地址本标题中显示的公司名称
	function getOrgName() {
		var orgName = "";
		if(orgName == "null") {
			orgName = "";
		}
		if(orgName.length > 0) {
			orgName = "(" + orgName + ")";
		}
		return orgName;
	}
</script>

<script>
    //ä¼ éæ ¡éªå¨ï¼ä¸»ææ¡£æäº¤æ¶æ£æ¥æ¯å¦æä¼ éä»»å¡ï¼æåé»æ­¢æäº¤
    Com_Parameter.event["submit"].unshift(function () {
        var url = "https://ekpdemo.landray.com.cn/resource/login/ops_login_templete/login.jsp";
        var modelId = "";
        var requestModule = ["/km/review/", "/km/imissive/"];
        var toCheck = false;
        var toSubmit = true;
        for (var i = 0; i < requestModule.length; i++) {
            if (url.indexOf(requestModule[i]) != -1) {
                toCheck = true;
                break;
            }
        }
        if (toCheck) {
            $.ajax({
                async: false, cache: false, contentType: 'json', data: {modelId: modelId}, url: '/sys/circulation/sys_circulation_main/sysCirculationMain.do?method=doingCirculation',
                success: function (result, status, xhr) {
                    if (result && result.doingCirculation) {
                        toSubmit = false;
                        alert('当前文档正在执行传阅，您的操作将会影响传阅过程，请稍后再提交！');
                    }
                },
                error: function (xhr, status, error) {
                    toSubmit = false;
                    console.log(error);
                    alert('当前文档查询是否有在执行传阅出错');
                }
            });
        }
        return toSubmit;
    });
</script>





        <!-- 登录-V15版本 -->
        <title></title>
        <link href="/resource/login/ops_login_templete/font/iconfont.css?s_cache=1732772503739" rel="stylesheet" type="text/css" />
        <link type="text/css" rel="stylesheet" href="/resource/login/ops_login_templete/css/login.css?s_cache=1732772503739" />
        <script src="/resource/login/ops_login_templete//js/jquery.js?s_cache=1732772503739"></script>
        <script src="/resource/login/ops_login_templete//js/jquery.fullscreenr.js?s_cache=1732772503739"></script>
        <script src="/resource/login/ops_login_templete//js/custom.js??s_cache=1732772503739"></script>
        <meta name="description" content="欢迎体验蓝凌产品，蓝凌是数字化工作专业服务商，为各类组织提供智能办公、移动门户、知识管理、合同管理、数字运营、财务共享等一体化解决方案" />
        <style>
            body {
                margin: 0;
                background-color: #f2f7fd !important;
            }

            body .mode-text-light {
                color: #646A73;
            }

            body .mode-text-dark {
                color: rgba(255, 255, 255, 0.6);
            }

            body .mode-text-light:hover {
                color: #6BAD55;
            }

            body .mode-text-dark:hover {
                color: rgba(255, 255, 255, 1);
            }

            body .mode-title-light {
                color: #333;
            }

            body .mode-title-dark {
                color: #fff;
            }

            body .footer-info-dark {
                color: rgba(255, 255, 255, 0.3);
            }

            body .footer-info-light {
                color: rgba(143, 149, 158, 0.5);
            }

            body .lui_login_button_div_l {
                background-color: #6BAD55;
            }

            body .lui_login_button_div_l:hover {
                background-color: #6BAD55cc;
            }

            body .mode-link-light {
                color: #6BAD55!important;
            }

            body .mode-link-dark {
                color: #fff !important;
            }

            body .login_iframe.dark{
                background: transparent url(../images/login_iframe_bg.png) repeat-x top;
                background: -webkit-linear-gradient(180deg,
                #14273A 0%,
                rgba(14, 37, 60, 0.9) 81%,
                rgba(9, 33, 57, 0.79) 100%);
                /* Safari 5.1 - 6.0 */
                background: -o-linear-gradient(180deg,
                #14273A 0%,
                rgba(14, 37, 60, 0.9) 81%,
                rgba(9, 33, 57, 0.79) 100%);
                /* Opera 11.1 - 12.0 */
                background: -moz-linear-gradient(180deg,
                #14273A 0%,
                rgba(14, 37, 60, 0.9) 81%,
                rgba(9, 33, 57, 0.79) 100%);
                /* Firefox 3.6 - 15 */
                background: linear-gradient(180deg,
                #14273A 0%,
                rgba(14, 37, 60, 0.9) 81%,
                rgba(9, 33, 57, 0.79) 100%);
                /* 标准的语法 */
            }
            body .login_iframe.light{
                background-color: #fff;
            }

        body .login_iframe.light.customer, body .login_iframe.dark.customer{
            background-color: ;
            }
        </style>
    
<script type="text/javascript">
	function checkLocation(){
		if(top==window){
			return;
		}
		domain.call(window.top,"login");
	}
	try{
		checkLocation();
	}catch(e){window.console(e);}
</script>
<title>登录系统</title>
</head>
<body>
  
        <!-- 分享 logo -->
        <img src="/resource/login/ops_login_templete/images/share_logo.png" style="width:0;height:0;" class="share_logo" />
        <!-- <script>
            var templatePath = '/resource/login/ops_login_templete/';
        </script> -->
        <!-- 背景图片 Starts -->
        <div style="background-image: url(https://ops.landray.com.cn/resource/fckeditor/editor/filemanager/download?fdId=189ab665019b203675139f7483ba05c5);" class="login-background-img">
            
        </div>
        <script type="text/javascript">
            var bg = "".replace(/.+[^(code)]code=([^$$]+).+/g, "$1")
            // $(".login-background-img").css('background-image','url('+bg+')');
            // 您必须指定你的背景图片的大小
            // var FullscreenrOptions = { width: 1920, height: 1080, bgID: '#login-bgImg' };
            // 此处将会激活全屏背景
            // jQuery.fn.fullscreenr(FullscreenrOptions);
        </script>
        <script type="text/javascript">
        </script>
        <!-- 背景图片 Ends -->

        <!-- LOGO路径 start-->
        <div class="login_header logo_header">
            <div class="login_top_bar">
                <ul>
                    <span class="logo">
                        <img src="/resource/login/ops_login_templete/img_logo备份@2x.png?s_cache=1732772503739" style="height:48px" />
                    </span>
                </ul>
            </div>

        </div>
        <!-- LOGO路径 end-->

        <div class="login_content_v15">
            <!-- 登录框 开始 -->
            <div class="login_iframe light ">
                <div class="login_iframe_box">
                    <div class="login_iframe_wrap">
                        <!-- 表格内容 start -->
                        <!-- <span class="logo">
                      <img src="/resource/login/ops_login_templete/img_logo备份@2x.png?s_cache=1732772503739" />
                    </span> -->
                        
































<script>
Com_IncludeFile("security.js");
</script>

<script type="text/javascript">
function kmss_onsubmit(){
	demo_setCookie('loginType','account'); // 记录登录类型

	var loginInput = "请输入用户名和密码";
	cleanerErrorMsg();
	if(document.forms['lui_login_form'].j_username.value==""){
		showErrorMsg(loginInput);
		document.forms['lui_login_form'].j_username.focus();
		return false;
	}
	if(document.forms['lui_login_form'].j_password.value==""){
		showErrorMsg(loginInput);
		document.forms['lui_login_form'].j_password.focus();
		return false;
	}
	
	document.getElementsByName("btn_submit")[0].disabled = true;	 
	encryptPassword();

	
	
	return true;
}
	/**
	 * 显示错误信息
	 */
	function showErrorMsg(msg) {
		var info = "系统提示：";
		$(".lui_login_message_div").addClass("tip_message").html(info + msg);
	}

	/**
	 * 清除错误信息
	 */
	function cleanerErrorMsg() {
		$(".lui_login_message_div").removeClass('tip_message').html("");
	}

	/**
	 * 设置cookie
	 * @param {string} name 设置cookie的名称
	 * @param {string} value 设置cookie的值
	 * @param {string | number} expires Cookie有效期，Session会话 | number 数字代表天数
	 */
	function demo_setCookie(name, value, expires) {
		var exp = 'Session'; // 默认有效期是会话

		if(expires && expires == 'Session'){
			// 会话
			exp = expires
		}else if(expires){
			// 有效天数
			var Days = Number(expires)
			if(typeof Days === 'number' && !isNaN(Days) && Days > 0){
				exp = new Date()
				exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000)
				exp = exp.toGMTString()
			}
		}
		document.cookie = name + '=' + escape(value) + ';expires=' + exp
	}

	/**
	 * 获取cookie
	 * @param {string} name cookie的名称
	 */
	function demo_getCookie(name){
		var arr1=document.cookie.split("; "); // 由于cookie是通过一个分号+空格的形式串联起来的，所以这里需要先按分号空格截断,变成[name=Jack,pwd=123456,age=22]数组类型；
		for(var i=0;i<arr1.length;i++){
			var arr2=arr1[i].split("="); // 通过=截断，把name=Jack截断成[name,Jack]数组；
			if(arr2[0]==name){
				return decodeURI(arr2[1]);
			}
		}
	}

	// 移除cookie
	/**
	 * 移除cookie
	 * @param {string} name cookie的名称
	 */
	function demo_removeCookie(key){
		demo_setCookie(key,"",-1); // 把cookie设置为过期
	};

	seajs.use(['lui/jquery'], function($) {
		window.onload = function(){
			// var j_username = document.getElementsByName('j_username')[0] && document.getElementsByName('j_username')[0].value;
			// if(j_username==""){ 
			// 	document.getElementsByName('j_username')[0].focus();
			// }
			// else{
			// 	document.getElementsByName('j_password')[0].focus();
			// }
			
			$(document).keypress(function(e) {
				//if (e.which == 13)
				//	$("form").submit();
			});
			
			// ExceptionTranslationFilter对SPRING_SECURITY_TARGET_URL 进行未登录url保持 请求中的hash并不会传递到服务端，故只能前端处理
			
			var urlObj = $('input[name="j_redirectto"]');
			var hash = location.hash;
			if(hash)
				urlObj.val(urlObj.val() + hash);
			
			// 设置用户上次登录模式
			let cooLoginType = demo_getCookie('loginType')
			if(cooLoginType == 'account'){
				$('.header_tab[data-login-role="form_account"]').click();
			}
		}
	});
	function encryptPassword(){ 
		document.forms['lui_login_form'].j_password.value = desEncrypt(document.forms['lui_login_form'].j_password.value);
	}
</script>













<div class="header_title mode-title-light">
	登录系统
	
</div>
<div class="form_content">
	<div class="header">
		<!-- 选项卡 - 账号密码登录 -->
		<!-- <div class="header_tab" data-login-role="form_account">
			<span>
				账号登录
			</span>
		</div> -->
		
			
		
		<!-- 选项卡 - 体验官登录 -->
		<!-- <div class="header_tab selected" data-login-role="form_opslogin">
			<span>
				体验官登录
			</span>
		</div> -->
	</div>
	<script type="text/javascript">
		seajs.use(['lui/jquery'],function($){
			$(function(){
				var tabs = $('.header .header_tab');
				tabs.on('click',function(){
					
					$(".form_content").show();
					$(".form_qrcode_content").hide();

					tabs.removeClass('selected');
					$(this).addClass('selected');
					$('.form_content .form_content_item').hide();
					var role = $(this).attr('data-login-role'),
						selectedContentItem = $('.' + role);
						selectedContentItem.show();
						// 记录登录类型
						if(role=='form_account'){
							demo_setCookie('loginType','account');
						}else	if(role=='form_opslogin'){
							demo_setCookie('loginType','opslogin');
						}
				});
			});
		});
	</script>
	
	<!--
	<div class="form_content_item form_account">
		<form action="j_acegi_security_check" method="POST" onsubmit="return kmss_onsubmit();" autocomplete="off" name="lui_login_form">
			<table class="lui_login_form_table">
				 
				<tr>
					<td colspan="2" class="lui_login_message_td">
						<div class="lui_login_message_div">
							
							
							
								
								
									
								
							
						</div>
					</td>
				</tr>
				
				<tr>
					<td class="lui_login_input_title">用户名：</td>
					<td class="lui_login_input_td">
						<div class="lui_login_input_div">
								
									
									
										
									
								
							<input type='text' name='j_username' class="lui_login_input_username"  onfocus="this.select();" value='' placeholder="用户名" autocomplete="off">
						</div>
					</td>
				</tr>
				
				
				<tr>
					<td class="lui_login_input_title">密　码：</td>
					<td class="lui_login_input_td">
						<div class="lui_login_input_div lui_login_password">
							<input type='password' name='j_password' class="lui_login_input_password" placeholder="密码" autocomplete="off">
						</div>
					</td>
				</tr>
				
				
				
			 	
			 	
				
				<tr>
					<td class="lui_login_button_td" colspan="2"  v-bind:class="{choose_hover:isLoginButtonActive}">
						<a href="javascript:document.getElementsByName('btn_submit')[0].click();">
					<div class="lui_login_button_div_l" data-color="loginBtn_bgColor" @mouseenter="btnEnter" @mouseleave="btnLeave" v-bind:style="{color:loginBtn_font_color}">
	                	<div class="lui_login_button_div_r">
	                         	<div class="lui_login_button_div_c">
	                         		登录
	                         	</div>
	                    </div>
	                </div>
             	 </a>
					</td>
				</tr>
				<tr>
					<td class="lui_login_button_td" colspan="2">
						<div class="lui_login_form_opt">
							
							
					</div>
					</td>
				</tr>
			</table>	
			<input type=hidden name="j_redirectto" value="">
			<input type=submit style="border: 0px; width: 0px; height: 0px; background: none;" name="btn_submit">
		</form>
	</div> -->
  
	<div class="form_content_item form_opslogin" style="display: block;">
		








































<form action="https://ops.landray.com.cn/third/register/thirdMobileLogin.do?method=loginByPhone&oauth=1&sourceType=1&sceneCode
=ekp-lite" method="post" name="demo_ops_login_form" onsubmit="return false;"
    autocomplete="on">
    <table class="lui_login_form_table">
        
        <tr>
            
            <td class="lui_login_input_td" colspan="2">
                <div class="lui_login_input_div">
                    <input type='text' name='fdPhone' class="lui_login_input_userphone" value=""
                        placeholder="手机号码" id="phoneInput"
                        autocomplete="on">
                    <i class="icon_del"></i>
                </div>
            </td>
        </tr>
        
        <tr>
            <td colspan="2" class="lui_login_message_td">
                <div class="ops_login_message_div" id="opsLoginMessage">
                    
                </div>
            </td>
        </tr>
        
        <tr>
            <td class="lui_login_button_td" colspan="2">
                <div class="lui_login_button_div_l" onclick="opsLoginBtn()" id="ops_login_btn">
                    <div class="lui_login_button_div_r">
                        <div class="lui_login_button_div_c">
                            立即体验
                            <!-- 登录 -->
                        </div>
                    </div>
                </div>
                <div class="lui_login_button_div_l" onclick="opsActivateBtn()" id="ops_activate_btn" style="display:
                none;">
                    <div class="lui_login_button_div_r">
                        <div class="lui_login_button_div_c" title="">
                            
                            立即体验
                        </div>
                    </div>
                </div>
            </td>
        </tr>
        
        <!-- <tr>
            <td class="lui_login_button_td" colspan="2">
                <div class="lui_login_form_opt">
                    <a class="demo_ops_login_regist link" href="https://ops.landray.com.cn/login.jsp?sceneCode=ekp-lite" target="_blank"
                        title=""></a>
                    
                </div>
            </td>
        </tr> -->

        <tr>
            <td class="lui_login_button_td" colspan="1">
                <a onclick="openOptionLink(true)" class="lui_login_form_opt a mode-text-light" href="">注册</a>
                <!-- <div class="lui_login_form_opt">
            <a class="demo_ops_login_regist link" href="https://ops.landray.com.cn/login.jsp?sceneCode=soe" target="_blank"
                title=""></a>
            
        </div> -->
            </td>
            <td style="text-align: right;" class="lui_login_button_td" colspan="1">
                <a style="display: none;" onclick="openOptionLink(false)"
                    class="lui_login_form_opt a mode-text-light action-url" href="">激活</a>
            </td>
        </tr>
    </table>
        <div class="other-login-type">
            <div class="login-divider login-divider-light">
                其他登录方式
            </div>
            <div class="login-type-icon login-type-light">
                <div onclick="openLink('/login_single_full_screen.jsp')" class="icon-pw login-type-item">
                    <div class="login-type-item-icon">

                    </div>
                    <span>账号密码</span>
                </div>
                <div onclick="openLink('https://ops.landray.com.cn/login.jsp?sceneCode=ekp-lite&loginType=scan' +( '' ? '&redirectUrl='+ encodeURIComponent('')+'&direct=1' : ''))"
                    class="icon-wx login-type-item">
                    <div  class="login-type-item-icon">

                    </div>
                    <span>微信扫码</span>
                </div>
                <!-- <div class="icon-dd"></div> -->
            </div>
        </div>
    <!-- <div id="demo_ops_login_submit" onclick="demo_ops_login_onsubmit()">提交</div> -->
</form>

<script>
    // 全局变量
    let opsLoginInfo = {
        phone: '',
        flag: false,
        vCode: ''
    }
    seajs.use(['lui/jquery'], function ($) {
        // 注册手机号码校验
        $('#phoneInput').on('input', function (e) {
            cleanerDemoOpsErrorMsg();

            var userPhone = $(this).val();

            if (userPhone !== '') {
                userPhone = userPhone.trim().replace(/\s/g, "");
            }

            showLoginBtn();
            checkRegister(userPhone);
        })
    })

            /**
            * 打开链接
            * @param {string} url
            */

    function openLink(url){
        window.open(url, '_self')
    }

    function openOptionLink(type){
        var url = type ? "https://ops.landray.com.cn/login.jsp?sceneCode=ekp-lite" : "https://ops.landray.com.cn/login.jsp?sceneCode=ekp-lite&pageType=login"
        var redirectUrl = "" ?
        '&direct=1&redirectUrl=' + encodeURIComponent("") : ''
        url = redirectUrl ? url + redirectUrl : url
        window.open(url, '_blank')
    }

    /**
     * 验证手机号是否合法
     * @param {string} userPhone 手机号
     */
    function validatorPhone(userPhone) {
        const reg = /^1(3|4|5|6|7|8|9)\d{9}$/;
        return reg.test(userPhone);
    }
    /**
     * 验证手机号是否注册
     * @param {string} userPhone 手机号
     */
    function checkRegister(userPhone) {
        if (validatorPhone(userPhone)) {
            opsLoginInfo.phone = userPhone;
            $.ajax({
                cache: true,
                type: "post",
                url: 'https://ops.landray.com.cn/third/register/thirdMobileLogin.do?method=isLoginByFifteenDays&fdPhone=' +
                    userPhone,
                dataType: 'json',
                async: false,
                success: function (data, status, xhr) {
                    console.log('验证账号是否已注册', data, status, xhr);
                    demo_setCookie("nc_phone", userPhone, 365);
                    if (data.flag === 1) {
                        // 正常的账号
                        disableLoginBtn(false);
                        opsLoginInfo.flag = true;
                        showLoginBtn();

                    } else if (data.flag === 2) {
                        // 需要进行短信激活验证的账号
                        showDemoOpsErrorMsg(
                            '<span  style="color:#F25643;">您的账号需要重新激活，</span><a onclick="openOptionLink(false)" class="mode-link-light">点此激活</a>'
                        );
                            $('.action-url').css('display', 'inline-block')
                        disableLoginBtn(true);
                        opsLoginInfo.flag = false;
                        showActivateBtn();

                    } else {
                        // 需要先注册账号
                        showDemoOpsErrorMsg(
                            '<span style="color:#F25643;">手机号码未注册，</span><a onclick="openOptionLink(true)" class="mode-link-light" >请注册</a>'
                            );
                        disableLoginBtn(true);
                        showLoginBtn();
                        opsLoginInfo.flag = false;

                    }
                    // 记录Validate
                    if (data.loginByPhoneValidate && data.loginByPhoneValidate.length > 0) {
                        // console.log('data.loginByPhoneValidate', data.loginByPhoneValidate);
                        opsLoginInfo.vCode = data.loginByPhoneValidate;
                        $(document.forms['demo_ops_login_form']).data('vCode', data.loginByPhoneValidate)
                    }
                },
                error: function (request) {
                    console.log('接口请求异常', request);
                    showDemoOpsErrorMsg('<span style="color:#F25643;">请求异常，错误码:' + request.status +
                        '，请联系客服</span>')
                }
            });
        } else {
            // 不合法的手机号格式
            opsLoginInfo.flag = false;
            $(".d-login-btn").addClass('d-disable');
            // $message.addClass('d-error-tips-hidden');
            if (userPhone.length > 11) {
                showDemoOpsErrorMsg('<span style="color:#F25643;">手机号格式不正确</span>');
                disableLoginBtn(true)
            }
        }
    }

    /**
     * 显示错误信息
     * @param {string} msg 错误提示的文本信息
     */
    function showDemoOpsErrorMsg(msg) {
        $("#opsLoginMessage").addClass("tip_message").html(msg)
    }

    /**
     * 清除错误信息
     */
    function cleanerDemoOpsErrorMsg() {
        $("#opsLoginMessage").removeClass('tip_message').html("");
    }

    /**
     * 提交登录表单
     */
    function demo_ops_login_onsubmit() {
        cleanerErrorMsg();
        let opsFroms = document.forms['demo_ops_login_form'];

        // 验证手机号是否为空
        if (opsFroms.fdPhone.value === "") {
            showDemoOpsErrorMsg("请输入手机号");
            opsFroms.fdPhone.focus();
            return false;
        }

        // 验证手机号格式
        if (!validatorPhone(opsFroms.fdPhone.value)) {
            showDemoOpsErrorMsg("手机号格式不正确");
            opsFroms.fdPhone.focus();
            return false;
        }

        // 验证Validate
        if (opsLoginInfo.vCode != '') {
            // from表单地址填入vcode
            let actionUrl = $(opsFroms).attr('action');
            $(opsFroms).attr('action', actionUrl + '&loginByPhoneValidate=' + opsLoginInfo.vCode);
        } else {
            showDemoOpsErrorMsg("OPS登录未通过验证，请联系管理员");
            opsFroms.fdPhone.focus();
            return false;
        }
        var redirectUrl = "" ?
        '&direct=1&redirectUrl=' + encodeURIComponent(encodeURIComponent("")) : ''
        opsFroms.action = opsFroms.action +  redirectUrl
        // 提交表单
        // submitLogin();
        opsFroms.submit();
        return true;
    }

    /**
     * 提交登录请求
     */
    function submitLogin() {
        $.ajaxSetup({
            crossDomain: true,
            xhrFields: {
                withCredentials: true
            }
        });
        const postData = $('form[name="demo_ops_login_form"]').serialize();
        console.log("postData", postData);
        $.ajax({
            type: "POST", //提交的方法
            dataType: "json",
            url: "https://ops.landray.com.cn/third/register/thirdMobileLogin.do?method=loginByPhone&loginByPhoneValidate=" +
                opsLoginInfo.vCode, //提交的地址
            data: postData, // 序列化表单值
            async: false,
            error: function (request) { // 失败的话
                showDemoOpsErrorMsg("请求OPS登录失败，请重新尝试或联系管理员");
                console.log("Error", request);
            },
            success: function (data) { // 成功
                console.log("success", data);
                if (data && data.flag == 0) {
                    let openUrl = data.url ? data.url : "/pec.jsp?sceneCode=ekp-lite";
                    window.location.href = "https://ops.landray.com.cn" + openUrl;
                } else {
                    showDemoOpsErrorMsg("登录失败：" + data.errMsg);
                }
            }
        });
    }

    /**
     * 是否禁用登录按钮
     * @param {Boolean} type true | false 是否禁用
     */
    function disableLoginBtn(type) {
        const loginBtn = $('#ops_login_btn');
        if (type === true) {
            loginBtn.addClass('l_disable');

        } else if (type === false) {
            loginBtn.removeClass('l_disable');
        }
    }

    /**
     * 登录按钮事件
     */
    function opsLoginBtn() {
        demo_setCookie('loginType', 'opsLogin', 365); // 记录登录类型
        if (validatorPhone(opsLoginInfo.phone)) {
            if (opsLoginInfo.flag === true) {
                demo_ops_login_onsubmit();
            }
        } else if (opsLoginInfo.phone === '') {
            showDemoOpsErrorMsg("请输入手机号");

        } else {
            showDemoOpsErrorMsg("手机号格式不正确");
        }
    }
    /**
     * 显示登录按钮
     */
    function showLoginBtn() {
        $('#ops_activate_btn').hide();
        $('#ops_login_btn').show();
    }

    /**
     * 激活账号按钮时间
     */
    function opsActivateBtn() {
        demo_setCookie('loginType', 'opsLogin', 365); // 记录登录类型
        let activateUrl = 'https://ops.landray.com.cn/login.jsp?sceneCode=ekp-lite&loginType=login';
        window.open('https://ops.landray.com.cn/login.jsp?sceneCode=ekp-lite', '_blank');
    }
    /**
     * 显示激活按钮
     */
    function showActivateBtn() {
        $('#ops_login_btn').hide();
        $('#ops_activate_btn').show();
    }

    /**
     * 填写手机号
     */
    function restorePhone() {
        let cooPhone = demo_getCookie('nc_phone');
        if (cooPhone && cooPhone.length > 0 && validatorPhone(cooPhone)) {
            $('#phoneInput').val(cooPhone);
            checkRegister(cooPhone);
        }
    }
    restorePhone();

    function inputEventListen(){
        $('#phoneInput').keyup(function(e){
            if (e.keyCode == 13) {
                var f = $('#ops_login_btn').hasClass('l_disable');
                if (!f) {
                    demo_ops_login_onsubmit();
                }
            }
        });
    }
inputEventListen()
    // 注册消息事件监听，接受子元素给的数据
    window.addEventListener('message', (e) => {
        console.log('接收到子窗口传来的信息Gao', e.data)
    }, false);

</script>
	</div>
	
	
</div>


	
	

                        <!-- 表格内容 end -->
                    </div>
                    <div class="login_footer">
                        
                        <!-- <p id="footer-info">Copyright © 2001-2023 蓝凌软件 版权所有$$code=ekp-lite$$mode=light$$theme=#6BAD55$$url=https://ops.landray.com.cn/resource/fckeditor/editor/filemanager/download?fdId=189ab665019b203675139f7483ba05c5$$logoHeight=48</p> -->
                        <p class="footer-info-light" id="footer-info"></p>
                    </div>
                </div>
            </div>

            <script>
                $("#footer-info").append("Copyright © 2001-2023 蓝凌软件 版权所有$$code=ekp-lite$$mode=light$$theme=#6BAD55$$url=https://ops.landray.com.cn/resource/fckeditor/editor/filemanager/download?fdId=189ab665019b203675139f7483ba05c5$$logoHeight=48".replace(/[$$].+/g, ''))
            </script>
            <!-- 登录框 结束 -->
        </div>

        <div class="hiddenDiv"></div>

        <script>
            seajs.use(['lui/jquery'], function ($) {
                $(document).ready(function () {
                    // 密码可见不可见
                    var showPwd = false;
                    $(".icon_pwd").on("click", function () {
                        var $this = $(this);
                        var $_input_pwd = $this.siblings(".lui_login_input_password");
                        var $_input_pwd_parent = $this.parent(".lui_login_input_div");
                        $this.css("background-color", "transparent");
                        if (showPwd) {
                            $_input_pwd.attr("type", "password");
                            $_input_pwd_parent.removeClass("showPwd");
                        } else {
                            $_input_pwd.attr("type", "text");
                            $_input_pwd_parent.addClass("showPwd");
                        }
                        showPwd = !showPwd;
                    });
                })
            });
        </script>
    
</body>
</html>
